<template>
    <div class="page" data-name="pagos-home" id="pagos-home">
        <div class="toolbar tabbar tabbar-labels toolbar-bottom menu">
            <div class="toolbar-inner">
                <a href="/home" class="tab-link profile">
                    <i class="icon material-icons">person</i>
                    <!-- <img src="//api.mydoctorize.com/files/user/userdetails/99/50.png" alt="not found"> -->
                </a>
                <a href="/schedule" class="tab-link">
                    <i class="icon material-icons">today</i>
                </a>
                <a href="#" class="tab-link">
                </a>
                <a href="/doctor/pagos" class="tab-link tab-link-active">
                    <i class="icon material-icons">monetization_on</i>
                </a>
                <a href="#" class="tab-link">
                    <i class="icon material-icons">notifications</i>
                </a>
            </div>
            <a class="add-circle popover-open" data-popover=".popover-menu">
                <div class="back-white"></div>
                <img src="/static/images/add_circle_24px_v2.svg" class="dynamic-sheet" alt="">
            </a>
        </div>
        <div class="header">
            <div class="pagos-home">
                <p class="title1">Pagos</p>
                <div class="fab fab-right-top color-white search">
                    <a href="#">
                        <i class="icon material-icons">search</i>
                    </a>
                </div>
            </div>

            <div class="toolbar tabbar toolbar-top">
                <div class="toolbar-inner">
                    <a href="#recibidos" id="recibidos_tab" class="tab-link tab-link-active">Recibidos</a>
                    <a href="#pendientes" id="pendientes_tab" class="tab-link">Pendientes</a>

                </div>
                <div class="styled-select">
                    <select name="sel">
                        <option value="All" selected>Todo</option>
                        <option value="Ten">Ãšltimos diez</option>
                        <option value="Month">Mes actual</option>
                        <option value="LastMonth">Mes anterior</option>
                    </select>
                </div>
            </div>

            <div class="TotalIncome">$100,899.00</div>
            <p class="labelIncome">Total de ingresos</p>
            <div class="labels">
                <p>nombre</p>
                <p>monto</p>
                <p>concepto</p>
            </div>
        </div>
        <div class="tabs">
            <div class="page-content tab tab-active" id="recibidos">
                <!-- <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        21
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Alejandro De Leon Lopez</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$600.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        18
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">William Alvarez</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$800.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Otro
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Leonardo Rodrigo Gonzalez</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$12,222.23</p>
                            <p class="no">Pago 2 / 9</p>
                        </div>
                        <hr>
                        <div class="concept">Cirugia
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        15
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Isabella Del Campo De La Rosa</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$500.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Rosa Catalina</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$600.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>

                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        11
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle yellow-2"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">David Mendoza</div>
                        <hr>
                        <div class="cash">
                            <p class="money">$600.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div> -->
            </div>
            <div class="page-content tab" id="pendientes">
                <!-- <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        21
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Alejandro De Leon Lopez</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$300.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        18
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">William Alvarez</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$800.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Otro
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Leonardo Rodrigo Gonzalez</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$120,500.00</p>
                            <p class="no">Pago 3 / 9</p>
                        </div>
                        <hr>
                        <div class="concept">Cirugia
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>
                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        15
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Isabella Del Campo De La Rosa</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$500.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">Rosa Catalina</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$600.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div>

                <div class="divider">
                    <div class="monthYear">
                        <p class="mon">ENE</p>
                        <p class="year">2020</p>
                    </div>
                    <div class="line">
                        <hr>
                    </div>
                    <div class="day">
                        11
                    </div>
                </div>

                <div class="card card-outline pagos">
                    <div class="rectangle red"></div>
                    <div class="card-content card-content-padding">
                        <div class="name">David Mendoza</div>
                        <hr>
                        <div class="cash">
                            <p class="money red">$600.00</p>
                            <p class="no">Pago 1 / 1</p>
                        </div>
                        <hr>
                        <div class="concept">Consulta
                            <i class="icon material-icons">chevron_right</i>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </div>
</template>
<script>
    import $$ from 'dom7';
    export default {
        on: {
            pageBeforeIn: function(e, page) {
                var self = this;
                var app = self.$app;

            },
            pageInit: function(e, page) {
                var self = this;
                var app = self.$app;
                var doctor = JSON.parse(sessionStorage.getItem('user'));
                var pagos;

                if (doctor != null && doctor != 'undefined' && doctor != '') {
                    $$(".toolbar .profile").html('<img src="' + app.data.url + doctor.img_data.url + '" alt="not found">');
                }

                app.preloader.show('blue');
                app.request.get(app.data.url,
                    function(e) {

                        pagos = JSON.parse(e);
                        let recibidos = [];
                        let pendientes = [];
                        $$('.header .TotalIncome').text('$100,899.00');
                        $$('.header .labelIncome').text('Total de ingresos');
                        fillPage('recibidos', recibidos);
                        fillPage('pendientes', pendientes);

                        app.preloader.hide();
                        $$('.header .toolbar .tab-link').click(function(x) {
                            let tab = $$(this);
                            if (tab.attr('id') == 'recibidos_tab') {
                                $$('.header .TotalIncome').text('$100,899.00'); //agregar valor
                                $$('.header .TotalIncome').toggleClass('light-blue');
                                $$('.header .labelIncome').text('Total de ingresos');

                                fillPage('recibidos');
                            } else if (tab.attr('id') == 'pendientes_tab') {
                                //llenar pagina
                                $$('.header .TotalIncome').text('$30,899.00'); //agregar valor
                                $$('.header .TotalIncome').toggleClass('light-blue');
                                $$('.header .labelIncome').text('Total pendientes');

                                fillPage('pendientes');
                            }
                        });

                        $$('#pagos-home .card.pagos').click(function(x) {
                            let card = $$(this);
                            if (card.parent().attr('id') == 'recibidos') {
                                app.data.store.setItem('details', 'recibidos').then(function(value) {
                                    app.methods.redirectTo('pago-details');
                                });
                            } else if (card.parent().attr('id') == 'pendientes') {
                                app.data.store.setItem('details', 'pendientes').then(function(value) {
                                    app.methods.redirectTo('pago-details');
                                });
                            }
                        });

                    },
                    function(e) {

                        let recibidos = [];
                        let pendientes = [];
                        $$('.header .TotalIncome').text('$100,899.00');
                        $$('.header .labelIncome').text('Total de ingresos');
                        fillPage('recibidos', recibidos);
                        fillPage('pendientes', pendientes);
                        app.preloader.hide();

                        $$('.header .toolbar .tab-link').click(function(x) {
                            let tab = $$(this);
                            if (tab.attr('id') == 'recibidos_tab') {
                                $$('.header .TotalIncome').text('$100,899.00'); //agregar valor
                                $$('.header .TotalIncome').toggleClass('light-blue');
                                $$('.header .labelIncome').text('Total de ingresos');

                                fillPage('recibidos');
                            } else if (tab.attr('id') == 'pendientes_tab') {
                                //llenar pagina
                                $$('.header .TotalIncome').text('$30,899.00'); //agregar valor
                                $$('.header .TotalIncome').toggleClass('light-blue');
                                $$('.header .labelIncome').text('Total pendientes');

                                fillPage('pendientes');
                            }
                        });

                        $$('#pagos-home .card.pagos').click(function(x) {
                            let card = $$(this);
                            console.log('card clicked redirect to details');
                            if (card.parent().attr('id') == 'recibidos') {
                                app.data.store.setItem('details', 'recibidos').then(function(value) {
                                    app.methods.redirectTo('pago-details');
                                });
                            } else if (card.parent().attr('id') == 'pendientes') {
                                app.data.store.setItem('details', 'pendientes').then(function(value) {
                                    app.methods.redirectTo('pago-details');
                                });
                            }
                        });

                    }
                );

                function fillPage(x, y) {
                    /* y.forEach(el => {
                        fillDay(x, el);
                    }); */
                    console.log('page');

                    for (let i = 0; i < 4; i++) {
                        fillDay(x, []);
                    }
                }

                function fillDay(x, y) {
                    /* y.forEach(el => {
                        fillDay(x, el);
                    }); */
                    /* $$('#'+x) */
                    let color, letter_color;
                    if (x == 'recibidos') {
                        color = 'yellow-2';
                        letter_color = '';
                    } else if (x == 'pendientes') {
                        color = 'red'
                        letter_color = 'red';
                    }
                    $$('#' + x).append(
                        '<div class="divider">' +
                        '<div class="monthYear">' +
                        '<p class="mon">ENE</p>' +
                        '<p class="year">2020</p>' +
                        '</div>' +
                        '<div class="line">' +
                        '<hr>' +
                        '</div>' +
                        '<div class="day">' +
                        '21' +
                        '</div>' +
                        '</div>'
                    );
                    for (let i = 0; i < 3; i++) {
                        $$('#' + x).append(
                            '<div class="card card-outline pagos">' +
                            '<div class="rectangle ' + color + '"></div>' +
                            '<div class="card-content card-content-padding">' +
                            '<div class="name">Alejandro De Leon Lopez</div>' +
                            '<hr>' +
                            '<div class="cash">' +
                            '<p class="money ' + letter_color + '">$300.00</p>' +
                            '<p class="no">Pago 1 / 1</p>' +
                            '</div>' +
                            '<hr>' +
                            '<div class="concept">Consulta' +
                            '<i class="icon material-icons">chevron_right</i>' +
                            '</div>' +
                            '</div>' +
                            '</div>'
                        );
                    }
                }
            }
        }
    }
</script>